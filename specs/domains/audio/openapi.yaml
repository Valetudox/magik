openapi: 3.0.3
info:
  title: Backend Audio API
  version: 1.0.0
  description: API for managing audio recordings and transcripts
  contact:
    name: API Support
    email: support@example.com
  license:
    name: MIT
    url: https://opensource.org/licenses/MIT

servers:
  - url: http://localhost:3002

tags:
  - name: Health
    description: Health check operations
  - name: Recordings
    description: Audio recording operations

paths:
  /health:
    get:
      summary: Health check endpoint
      description: Check if the service is running and healthy
      operationId: healthCheck
      tags:
        - Health
      responses:
        '200':
          description: Service is healthy
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: ok
                required:
                  - status

  /api/recordings:
    get:
      summary: List all recordings
      description: Retrieve a list of all audio recordings stored in the system
      operationId: listRecordings
      tags:
        - Recordings
      responses:
        '200':
          description: List of recordings
          content:
            application/json:
              schema:
                type: object
                properties:
                  recordings:
                    type: array
                    items:
                      $ref: '#/components/schemas/Recording'
                  total:
                    type: integer
                required:
                  - recordings
                  - total
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

  /api/recordings/{id}:
    get:
      summary: Get a specific recording
      description: Retrieve details of a specific audio recording by its ID
      operationId: getRecording
      tags:
        - Recordings
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Recording details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Recording'
        '404':
          description: Recording not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

components:
  schemas:
    Recording:
      type: object
      additionalProperties: false
      properties:
        id:
          type: string
        filename:
          type: string
        format:
          type: string
          enum: [wav, mp3]
        size:
          type: integer
        createdAt:
          type: string
          format: date-time
        modifiedAt:
          type: string
          format: date-time
        hasTranscript:
          type: boolean
        transcriptMetadata:
          type: object
          additionalProperties: false
          properties:
            duration:
              type: number
            language:
              type: string
            diarization:
              type: string
            jobId:
              type: string
            transcriptCreatedAt:
              type: string
              format: date-time
      required:
        - id
        - filename
        - format
        - size
        - createdAt
        - modifiedAt
        - hasTranscript

    Error:
      type: object
      additionalProperties: false
      properties:
        error:
          type: string
      required:
        - error
