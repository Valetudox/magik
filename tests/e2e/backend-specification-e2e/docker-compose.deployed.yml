services:
  schemathesis:
    image: python:3.11-slim
    volumes:
      - ../../../apps/backend-specification/openapi.yaml:/schema/openapi.yaml:ro
      - ./schemathesis-tests:/tests:ro
      - /tmp:/tmp:rw
    working_dir: /tests
    environment:
      - TEST_BASE_URL=${TEST_BASE_URL:-http://localhost/api}
    command: >
      bash -c "
        pip install --no-cache-dir -r requirements.txt &&
        pytest test_specification_api.py --base-url=$${TEST_BASE_URL} -v
      "
