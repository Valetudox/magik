import type { FastifyRequest, FastifyReply } from 'fastify'

{{#if (eq method 'get')}}
{{#if (contains route ':')}}
interface {{pascalCase functionName}}Params {
  {{#each (extractParams route)}}
  {{this}}: string
  {{/each}}
}

export async function {{camelCase functionName}}(
  request: FastifyRequest<{ Params: {{pascalCase functionName}}Params }>,
  reply: FastifyReply
) {
  try {
    const { {{#each (extractParams route)}}{{this}}{{#unless @last}}, {{/unless}}{{/each}} } = request.params

    return { success: true }
  } catch (error: unknown) {
    reply.status(500).send({ error: error instanceof Error ? error.message : 'Unknown error' })
  }
}
{{else}}
export async function {{camelCase functionName}}(
  request: FastifyRequest,
  reply: FastifyReply
) {
  try {
    return { success: true }
  } catch (error: unknown) {
    reply.status(500).send({ error: error instanceof Error ? error.message : 'Unknown error' })
  }
}
{{/if}}
{{else if (or (eq method 'post') (eq method 'patch') (eq method 'put'))}}
{{#if (contains route ':')}}
interface {{pascalCase functionName}}Params {
  {{#each (extractParams route)}}
  {{this}}: string
  {{/each}}
}
{{/if}}

interface {{pascalCase functionName}}Body {}

export async function {{camelCase functionName}}(
  request: FastifyRequest<{ {{#if (contains route ':')}}Params: {{pascalCase functionName}}Params; {{/if}}Body: {{pascalCase functionName}}Body }>,
  reply: FastifyReply
) {
  try {
    {{#if (contains route ':')}}
    const { {{#each (extractParams route)}}{{this}}{{#unless @last}}, {{/unless}}{{/each}} } = request.params
    {{/if}}
    const body = request.body

    return { success: true }
  } catch (error: unknown) {
    reply.status(500).send({ error: error instanceof Error ? error.message : 'Unknown error' })
  }
}
{{else if (eq method 'delete')}}
{{#if (contains route ':')}}
interface {{pascalCase functionName}}Params {
  {{#each (extractParams route)}}
  {{this}}: string
  {{/each}}
}

export async function {{camelCase functionName}}(
  request: FastifyRequest<{ Params: {{pascalCase functionName}}Params }>,
  reply: FastifyReply
) {
  try {
    const { {{#each (extractParams route)}}{{this}}{{#unless @last}}, {{/unless}}{{/each}} } = request.params

    return { success: true }
  } catch (error: unknown) {
    reply.status(500).send({ error: error instanceof Error ? error.message : 'Unknown error' })
  }
}
{{else}}
export async function {{camelCase functionName}}(
  request: FastifyRequest,
  reply: FastifyReply
) {
  try {
    return { success: true }
  } catch (error: unknown) {
    reply.status(500).send({ error: error instanceof Error ? error.message : 'Unknown error' })
  }
}
{{/if}}
{{/if}}
